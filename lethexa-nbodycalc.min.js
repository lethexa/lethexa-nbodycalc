!function(a){"use strict";a.withMathFunc=function(a){return{GravitySimulator:function(){var b=[],c=6.67e-11;this.addBody=function(a){b.push(a)},this.removeBody=function(a){var c=b.indexOf(a);b.splice(c,1)};var d=function(b,c,d,e){var f=a.sub(d,e),g=Math.sqrt(a.lengthSquared(f));if(0===g)return a.nullVector();var h=b*c/(g*g*g);return a.mulScalar(f,h)},e=function(c,e,f){var g=a.nullVector();return b.forEach(function(b){b!==c&&(g=a.add(g,d(e,b.mass,b.position,f)))}),g},f=function(){for(var b=a.nullVector(),c=0;c<arguments.length;c++)b=a.add(b,arguments[c]);return b};this.updateTime=function(d){b.forEach(function(b){var g=b.position,h=b.velocity,i=e(b,c,g),j=.5*d,k=h,l=i,m=a.add(g,a.mulScalar(k,j)),n=a.add(h,a.mulScalar(l,j)),o=e(b,c,m),p=a.add(g,a.mulScalar(n,j)),q=a.add(h,a.mulScalar(o,j)),r=e(b,c,p),s=a.add(g,a.mulScalar(q,d)),t=a.add(h,a.mulScalar(r,d)),u=e(b,c,s),v=a.mulScalar(f(k,a.mulScalar(n,2),a.mulScalar(q,2),t),1/6),w=a.mulScalar(f(l,a.mulScalar(o,2),a.mulScalar(r,2),u),1/6);g=a.add(g,a.mulScalar(v,d)),h=a.add(h,a.mulScalar(w,d)),b.position=g,b.velocity=h})}}}}}("undefined"==typeof exports?this.nbodycalc={}:exports);